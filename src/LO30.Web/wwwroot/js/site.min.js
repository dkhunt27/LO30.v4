"use strict";var lo30NgApp=angular.module("lo30NgApp",["ngRoute","ngAnimate","ui.bootstrap","ui.select","ngSanitize","matchMedia","datatables","datatables.bootstrap","datatables.buttons","datatables.light-columnfilter","datatables.fixedcolumns","ui.footable"]);lo30NgApp.constant("constApisUrl","/api"),lo30NgApp.constant("constScheduleTeamFeedBaseUrl","localhost:5000"),lo30NgApp.config(function(e){e.when("/standings/seasons/:seasonId/seasonType/:seasonTypeId",{controller:"standingsController",templateUrl:"/views/standings.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.when("/stats/players/types/:type/seasons/:seasonId/seasonType/:seasonTypeId",{controller:"statsPlayersController",templateUrl:"/views/statsPlayers.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.when("/players/:playerId/types/:type",{controller:"playersController",templateUrl:"/views/players.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.when("/players/:playerId/types/:type/seasons/:seasonId",{controller:"playersController",templateUrl:"/views/players.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.when("/teams/:teamId/seasons/:seasonId",{controller:"teamsController",templateUrl:"/views/teams.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.when("/boxscores/games/:gameId/seasons/:seasonId",{controller:"gameBoxScoreController",templateUrl:"/views/gameBoxScore.html",resolve:{criteriaServiceResolved:["criteriaService",function(e){return e.initialize().then(function(a){return e})}]}}),e.otherwise({redirectTo:"/"})}),lo30NgApp.config(function(e,a){var t=!0,o=!0,s=!0;e.debugEnabled(s),a.decorator("$log",function(e){var a=e.info,s=e.log;return e.info=function(){o&&a.apply(null,arguments)},e.log=function(){t&&s.apply(null,arguments)},e})}),lo30NgApp.controller("gameBoxScoreController",function(e,a,t,o,s){s._;e.initializeScopeVariables=function(){e.local={selectedGameId:3480,selectedSeasonId:56}},e.setWatches=function(){},e.activate=function(){e.initializeScopeVariables(),e.setWatches(),a.seasonId&&(e.local.selectedSeasonId=parseInt(a.seasonId,10),t.season.setById(e.local.selectedSeasonId)),a.gameId&&(e.local.selectedGameId=parseInt(a.gameId,10),t.game.setById(e.local.selectedGameId)),e.local.criteriaSeason=t.season.get(),e.local.criteriaSeasonType=t.seasonType.get(),e.local.criteriaGame=t.game.get()},e.activate()}),lo30NgApp.controller("playersController",function(e,a,t,o,s,l,r,n){var i=n._;e.initializeScopeVariables=function(){e.local={selectedPlayerId:593,selectedSeasonId:56,selectedType:"skater",playerStatGames:[],playerStatTeams:[],playerStatSeasons:[],playerStatCareer:{},playerStatGamesToDisplay:[],playerStatTeamsToDisplay:[],playerStatSeasonsToDisplay:[],playerStatCareerToDisplay:[],fetchplayerStatGamesCompleted:!1,fetchPlayerStatTeamsCompleted:!1,fetchplayerStatSeasonsCompleted:!1,fetchplayerStatCareerCompleted:!1,tabStates:{season:!1,career:!1,profile:!1}}},e.sortAscOnly=function(a){e.sortOn=a,e.sortDirection=!1},e.sortDescOnly=function(a){e.sortOn=a,e.sortDirection=!0},e.sortAscFirst=function(a){e.sortOn===a?e.sortDirection=!e.sortDirection:(e.sortOn=a,e.sortDirection=!1)},e.sortDescFirst=function(a){e.sortOn===a?e.sortDirection=!e.sortDirection:(e.sortOn=a,e.sortDirection=!0)},e.sortClass=function(a,t){var o="";return e.sortOn===a&&(o=e.sortDirection===!0?"fa fa-sort-desc":"fa fa-sort-asc"),o},e.fetchPlayerStatCareer=function(a,t){e.local.fetchplayerStatCareerCompleted=!1,e.local.playerStatCareer={};var s="playerStatCareers";"goalie"===t&&(s="goalieStatCareers"),o[s].getForPlayerId(a).then(function(a){e.local.playerStatCareer=a,e.buildPlayerStatCareerToDisplay()})["finally"](function(){e.local.fetchplayerStatCareerCompleted=!0})},e.fetchPlayerStatSeasons=function(a,t){e.local.fetchPlayerStatSeasonsCompleted=!1,e.local.playerStatSeasons=[];var s="playerStatSeasons";"goalie"===t&&(s="goalieStatSeasons"),o[s].listForPlayerId(a).then(function(a){e.local.playerStatSeasons=i.sortBy(a,function(e){return e.seasonName}),e.buildPlayerStatSeasonsToDisplay()})["finally"](function(){e.local.fetchPlayerStatSeasonsCompleted=!0})},e.fetchPlayerStatTeams=function(a,t,s){e.local.fetchPlayerStatTeamsCompleted=!1,e.local.playerStatTeams=[];var l="playerStatTeams";"goalie"===s&&(l="goalieStatTeams"),o[l].listForPlayerIdSeasonId(a,t).then(function(a){e.local.playerStatTeams=i.sortBy(a,function(e){return e.sub}),e.buildPlayerStatTeamsToDisplay()})["finally"](function(){e.local.fetchPlayerStatTeamsCompleted=!0})},e.fetchPlayerStatGames=function(a,t,s){e.local.fetchPlayerStatGamesCompleted=!1,e.local.playerStatGames=[];var l="playerStatGames";"goalie"===s&&(l="goalieStatGames"),o[l].listForPlayerIdSeasonId(a,t).then(function(a){e.local.playerStatGames=i.sortBy(a,function(e){return-1*e.gameId}),e.buildPlayerStatGamesToDisplay()})["finally"](function(){e.local.fetchPlayerStatGamesCompleted=!0})},e.buildPlayerStatCareerToDisplay=function(){e.local.playerStatCareerToDisplay=e.local.playerStatCareer;var a=e.local.playerStatCareerToDisplay;l.is("xs, sm")?(a.playerNameToDisplay=a.playerFirstName+"<br/>"+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix)):l.is("md")?(a.playerNameToDisplay=a.playerFirstName+"<br/>"+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix)):(a.playerNameToDisplay=a.playerFirstName+" "+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix))},e.buildPlayerStatSeasonsToDisplay=function(){e.local.playerStatSeasonsToDisplay=e.local.playerStatSeasons.map(function(e,a){return e.rank=a+1,l.is("xs, sm")?(e.playerNameToDisplay=e.playerFirstName+"/n"+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)):l.is("md")?(e.playerNameToDisplay=e.playerFirstName+"/n"+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)):(e.playerNameToDisplay=e.playerFirstName+" "+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)),e})},e.buildPlayerStatTeamsToDisplay=function(){e.local.playerStatTeamsToDisplay=e.local.playerStatTeams.map(function(e,a){return e.rank=a+1,l.is("xs, sm")?(e.teamNameToDisplay=e.teamNameCode,e.playerNameToDisplay=e.playerFirstName+"<br/>"+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)):l.is("md")?(e.teamNameToDisplay=e.teamNameShort,e.playerNameToDisplay=e.playerFirstName+"<br/>"+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)):(e.teamNameToDisplay=e.teamNameShort,e.playerNameToDisplay=e.playerFirstName+" "+e.playerLastName,e.playerSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerSuffix)),e})},e.buildPlayerStatGamesToDisplay=function(){e.local.playerStatGamesToDisplay=e.local.playerStatGames.map(function(e,a){return e.rank=a+1,e.teamNameToDisplay=l.is("xs, sm")?e.teamNameCode:l.is("md")?e.teamNameShort:e.teamNameShort,e})},e.setWatches=function(){e.$watch("local.tabStates.season",function(a,t){a!==t&&a&&(e.fetchPlayerStatTeams(e.local.selectedPlayerId,e.local.selectedSeasonId,e.local.selectedType),e.fetchPlayerStatGames(e.local.selectedPlayerId,e.local.selectedSeasonId,e.local.selectedType))}),e.$watch("local.tabStates.career",function(a,t){a!==t&&a&&(e.fetchPlayerStatCareer(e.local.selectedPlayerId,e.local.selectedType),e.fetchPlayerStatSeasons(e.local.selectedPlayerId,e.local.selectedType))})},e.activate=function(){e.initializeScopeVariables(),e.setWatches(),a.playerId&&(e.local.selectedPlayerId=parseInt(a.playerId,10)),a.seasonId&&(e.local.selectedSeasonId=parseInt(a.seasonId,10),s.season.setById(e.local.selectedSeasonId),e.local.criteriaSeason=s.season.get(),e.local.criteriaGame=s.game.get()),a.type&&(e.local.selectedType=a.type),a.tab?t(function(){e.local.tabStates[a.tab]=!0},100):t(function(){e.local.tabStates.season=!0},100)},e.activate()}),lo30NgApp.controller("standingsController",function(e,a,t,o,s,l,r,n,i,c){a.initializeScopeVariables=function(){a.local={teamStandings:[],teamStandingsByDiv:[],teamStandingsToDisplay:[],fetchTeamStandingsCompleted:!1}},a.sortAscOnly=function(e){a.sortOn=e,a.sortDirection=!1},a.sortDescOnly=function(e){a.sortOn=e,a.sortDirection=!0},a.sortAscFirst=function(e){a.sortOn===e?a.sortDirection=!a.sortDirection:(a.sortOn=e,a.sortDirection=!1)},a.sortDescFirst=function(e){a.sortOn===e?a.sortDirection=!a.sortDirection:(a.sortOn=e,a.sortDirection=!0)},a.sortClass=function(e,t){var o="";return a.sortOn===e&&(o=a.sortDirection===!0?"fa fa-sort-desc":"fa fa-sort-asc"),o},a.fetchTeamStandings=function(e,t){a.local.fetchTeamStandingsCompleted=!1,a.local.teamStandings=[],a.local.teamStandingsByDiv=[],s.teamStandings.listForSeasonIdPlayoffs(e,t).then(function(e){a.local.teamStandings=e,a.buildTeamStandingsToDisplay(a.local.teamStandings),a.parseTeamStandingsIntoDivisions(a.local.teamStandingsToDisplay)})["finally"](function(){a.local.fetchTeamStandingsCompleted=!0})},a.parseTeamStandingsIntoDivisions=function(t){var o=_.pluck(t,"divisionLongName"),s=_.uniq(o);s.forEach(function(e){var o=_.filter(t,function(a){return a.divisionLongName===e});a.local.teamStandingsByDiv.push({division:e,teamStandings:o})}),e.debug("teamStandingsByDiv",a.local.teamStandingsByDiv)},a.buildTeamStandingsToDisplay=function(t){a.local.teamStandingsToDisplay=t.map(function(e){return e.teamNameToDisplay=r.is("xs, sm")?e.teamCode:r.is("md")?e.teamNameShort:e.teamNameLong,e}),e.debug("teamStandingsToDisplay",a.local.teamStandingsToDisplay)},a.fetchData=function(){a.local.criteriaSeason=l.season.get(),a.local.criteriaSeasonType=l.seasonType.get(),a.local.criteriaGame=l.game.get();var e;e="Playoffs"===a.local.criteriaSeasonType?!0:!1,a.fetchTeamStandings(a.local.criteriaSeason.seasonId,e)},a.setWatches=function(){},a.activate=function(){a.initializeScopeVariables(),a.setWatches(),l.season.setById(parseInt(o.seasonId,10)),l.seasonType.set("1"===o.seasonTypeId?"Playoffs":"Regular Season"),a.fetchData(),t(function(){a.sortAscFirst("ranking")},0)},a.activate()}),lo30NgApp.controller("statsPlayersController",function(e,a,t,o,s,l,r,n){var i=n._;e.initializeScopeVariables=function(){e.positions=["F","D","G"],e.subs=["With","Without"],e.lines=["1","2","3"],e.local={screenSizeIsDesktop:!1,screenSizeIsTablet:!1,screenSizeIsMobile:!1,selectedType:"skater",playerStatTeams:[],playerStatTeamsToDisplay:[],teams:[],fetchPlayerStatTeamsCompleted:!1,fetchTeamsCompleted:!1,searchText:null,selectedTeam:null,selectedPosition:null,selectedLine:null,selectedSub:null,criteriaSeason:{}}},e.filterByTeam=function(a){var t;t=e.local.screenSizeIsMobile?a.teamCode:e.local.screenSizeIsTablet?a.teamNameShort:a.teamNameShort;var o="team:"+e.local.selectedTeam,s="team:"+t;e.local.selectedTeam&&e.removeExistingSearchFromSearch(o),e.local.selectedTeam===t?e.local.selectedTeam=null:(e.prepSearchForNewSearch(),e.addNewSearchToSearch(s),e.local.selectedTeam=t)},e.filterBySub=function(a){var t="sub:"+e.filterBySubMapper(e.local.selectedSub),o="sub:"+e.filterBySubMapper(a);e.local.selectedSub&&e.removeExistingSearchFromSearch(t),e.local.selectedSub===a?e.local.selectedSub=null:(e.prepSearchForNewSearch(),e.addNewSearchToSearch(o),e.local.selectedSub=a),e.resetSort()},e.filterBySubMapper=function(e){var a;switch(e){case"With":a="Y";break;case"Without":a="N";break;default:a=e}return a},e.filterByLine=function(a){var t="line:"+e.local.selectedLine,o="line:"+a;e.local.selectedLine&&e.removeExistingSearchFromSearch(t),e.local.selectedLine===a?e.local.selectedLine=null:(e.prepSearchForNewSearch(),e.addNewSearchToSearch(o),e.local.selectedLine=a),e.resetSort()},e.filterByPosition=function(a){var t="pos:"+e.local.selectedPosition,o="pos:"+a;e.local.selectedPosition&&e.removeExistingSearchFromSearch(t),e.local.selectedPosition===a?e.local.selectedPosition=null:(e.prepSearchForNewSearch(),e.addNewSearchToSearch(o),e.local.selectedPosition=a),e.resetSort()},e.resetSort=function(e){},e.addNewSearchToSearch=function(a){e.local.searchText=e.local.searchText+a},e.removeExistingSearchFromSearch=function(a){e.local.searchText=e.local.searchText.replace(", "+a,""),e.local.searchText=e.local.searchText.replace(a+", ",""),e.local.searchText=e.local.searchText.replace(a,"")},e.prepSearchForNewSearch=function(){e.local.searchText=e.local.searchText?e.local.searchText+", ":""},e.sortAscOnly=function(a){e.sortOn=a,e.sortDirection=!1},e.sortDescOnly=function(a){e.sortOn=a,e.sortDirection=!0},e.sortAscFirst=function(a){e.sortOn===a?e.sortDirection=!e.sortDirection:(e.sortOn=a,e.sortDirection=!1)},e.sortDescFirst=function(a){e.sortOn===a?e.sortDirection=!e.sortDirection:(e.sortOn=a,e.sortDirection=!0)},e.sortClass=function(a,t){var o="";return e.sortOn===a&&(o=e.sortDirection===!0?"fa fa-sort-desc":"fa fa-sort-asc"),o},e.removeSearch=function(){e.local.searchText=null,e.local.selectedTeam=null,e.local.selectedPosition=null,e.local.selectedLine=null,e.local.selectedSub=null},e.fetchPlayerStatTeams=function(a,t){e.local.fetchPlayerStatTeamsCompleted=!1,e.local.playerStatTeams=[];var s="playerStatTeams";"goalie"===e.local.selectedType&&(s="goalieStatTeams"),o[s].listForSeasonIdPlayoffs(a,t).then(function(a){e.local.playerStatTeams=i.sortBy(a,function(e){return-1*e.points}),e.buildPlayerStatTeamsToDisplay()})["finally"](function(){e.local.fetchPlayerStatTeamsCompleted=!0})},e.buildPlayerStatTeamsToDisplay=function(){e.local.playerStatTeamsToDisplay=e.local.playerStatTeams.map(function(a,t){return a.sub=a.sub?"Y":"N",a.rank=t+1,e.local.screenSizeIsMobile?(a.teamNameToDisplay=a.teamCode,a.playerNameToDisplay=a.playerFirstName+" "+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix)):e.local.screenSizeIsTablet?(a.teamNameToDisplay=a.teamNameShort,a.playerNameToDisplay=a.playerFirstName+" "+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix)):(a.teamNameToDisplay=a.teamNameShort,a.playerNameToDisplay=a.playerFirstName+" "+a.playerLastName,a.playerSuffix&&(a.playerNameToDisplay=a.playerNameToDisplay+" "+a.playerSuffix)),a})},e.fetchTeams=function(a){e.local.fetchTeamsCompleted=!1,e.local.teams=[],o.teams.listForSeasonId(a).then(function(a){e.local.teams=a,angular.forEach(a,function(a,t){e.buildTeamsToDisplay()})})["finally"](function(){e.local.fetchScoreSheetEntryGoalsCompleted=!0})},e.buildTeamsToDisplay=function(){e.local.teamsToDisplay=e.local.teams.map(function(a,t){return a.rank=t+1,a.teamNameToDisplay=e.local.screenSizeIsMobile?a.teamCode:e.local.screenSizeIsTablet?a.teamNameShort:a.teamNameShort,a})},e.fetchData=function(){e.local.criteriaSeason=s.season.get(),e.local.criteriaSeasonType=s.seasonType.get(),e.local.criteriaGame=s.game.get();var a;a="Playoffs"===e.local.criteriaSeasonType?!0:!1,e.fetchTeams(e.local.criteriaSeason.seasonId),e.fetchPlayerStatTeams(e.local.criteriaSeason.seasonId,a)},e.setWatches=function(){},e.activate=function(){e.initializeScopeVariables(),e.setWatches(),e.local.screenSizeIsDesktop=l.is("lg"),e.local.screenSizeIsTablet=l.is("md"),e.local.screenSizeIsMobile=l.is("xs, sm"),s.season.setById(parseInt(a.seasonId,10)),s.seasonType.set("1"===a.seasonTypeId?"Playoffs":"Regular Season"),a.type&&(e.local.selectedType=a.type),e.fetchData(),t(function(){"skater"===e.local.selectedType?e.sortDescFirst("points"):e.sortAscFirst("goalsAgainstAverage"),e.filterBySub("Without")},0)},e.activate()}),lo30NgApp.controller("teamsController",function(e,a,t,o,s,l,r,n,i,c,m,p){var y=i._;a.initializeScopeVariables=function(){a.local={selectedTeamId:318,selectedSeasonId:56,selectedTeam:"not set",teamStandings:[],teamStandingsToDisplay:[],games:[],gamesToDisplay:[],gamesToDisplayCompleted:[],gamesToDisplayUpcoming:[],teamFeed:{},fetchTeamStandingsCompleted:!1,fetchGamesCompleted:!1,tabStates:{completed:!1,upcoming:!1}}},a.fetchTeamStandings=function(e,t){a.local.fetchTeamStandingsCompleted=!1,a.local.teamStandings=[],s.teamStandings.listForSeasonIdTeamId(e,t).then(function(e){a.local.teamStandings=e,a.buildTeamStandingsToDisplay(),a.buildTeamFeed()})["finally"](function(){a.local.fetchTeamStandingsCompleted=!0})},a.buildTeamStandingsToDisplay=function(){a.local.teamStandingsToDisplay=a.local.teamStandings.map(function(e){return a.selectedTeamName=e.teamNameLong,e.teamNameToDisplay=r.is("xs, sm")?e.teamCode:r.is("md")?e.teamNameShort:e.teamNameLong,e}),e.debug("teamStandingsToDisplay",a.local.teamStandingsToDisplay)},a.buildTeamFeed=function(){var t=a.local.teamStandings[0],o=t.seasonId,s=t.teamId,l=t.teamNameLong.replace(/ /g,"").replace(/\//g,"").replace(/-/g,"").replace(/\./g,""),r=t.seasonName.replace(/ /g,"");a.local.teamFeed={teamCode:t.teamCode,teamNameLong:t.teamNameLong,teamNameShort:t.teamNameShort,teamFeedUrl:p+"/Schedule/TeamFeed/Seasons/"+o+"/Teams/"+s+"/LO30Schedule-"+l+"-"+r},e.debug("teamFeed",a.local.teamFeed)},a.fetchGames=function(e,t){a.local.fetchGamesCompleted=!1,a.local.games=[],s.games.listForSeasonIdTeamId(e,t).then(function(e){a.local.games=e,a.buildGamesToDisplay()})["finally"](function(){a.local.fetchGamesCompleted=!0})},a.buildGamesToDisplay=function(){a.local.gamesToDisplay=a.local.games.map(function(e,t){return e.outcomeToDisplay=e.outcomeAway,e.teamIdHome===a.local.selectedTeamId&&(e.outcomeToDisplay=e.outcomeHome),e.overridenAway&&(e.outcomeToDisplay=e.outcomeToDisplay+"*"),r.is("xs, sm")?(e.awayTeamToDisplay=e.teamCodeAway,e.homeTeamToDisplay=e.teamCodeHome):r.is("md")?(e.awayTeamToDisplay=e.teamNameShortAway,e.homeTeamToDisplay=e.teamNameShortHome):(e.awayTeamToDisplay=e.teamNameLongAway,e.homeTeamToDisplay=e.teamNameLongHome),e}),a.local.gamesToDisplayCompleted=y.filter(a.local.gamesToDisplay,function(e){return null!==e.outcomeHome}),a.local.gamesToDisplayCompleted=y.sortBy(a.local.gamesToDisplayCompleted,function(e){return-1*e.gameId}),a.local.gamesToDisplayUpcoming=y.filter(a.local.gamesToDisplay,function(e){return null===e.outcomeHome}),a.local.gamesToDisplayUpcoming=y.sortBy(a.local.gamesToDisplayUpcoming,function(e){return e.gameId})},a.activate=function(){a.initializeScopeVariables(),t.teamId&&(a.local.selectedTeamId=parseInt(t.teamId,10)),t.seasonId&&(a.local.selectedSeasonId=parseInt(t.seasonId,10),l.season.setById(a.local.selectedSeasonId)),a.local.criteriaSeason=l.season.get(),a.local.criteriaSeasonType=l.seasonType.get(),a.local.criteriaGame=l.game.get(),t.tab?o(function(){a.local.tabStates[t.tab]=!0},100):o(function(){a.local.tabStates.completed=!0},100),a.fetchTeamStandings(a.local.selectedSeasonId,a.local.selectedTeamId),a.fetchGames(a.local.selectedSeasonId,a.local.selectedTeamId)},a.activate()}),lo30NgApp.filter("filterize",function(e){var a=function(a){var t=[],o=a.split(",");return angular.forEach(o,function(a){var o=a.split(":");if(0!==o.length&&o[1]){var s,l=o[0].replace(/(^\s+|\s+$)/g,""),r=o[1].toLowerCase();switch(l.toLowerCase()){case"rank":s="ranking";break;case"team":s=e.is("xs, sm")?"teamCode":"teamNameShort";break;case"player":s="player";break;case"pos":case"position":s="position";break;case"line":s="line";break;case"sub":s="sub"}t.push({key:s,value:r})}else t.push({key:"TEXTONLY",value:o})}),t};return function(e,t){if(!t)return e;var o=a(t),s=[];return angular.forEach(e,function(e){var a=[];angular.forEach(o,function(t){if("TEXTONLY"===t.key)-1!==JSON.stringify(e).toLowerCase().indexOf(t.value)&&a.push(e);else{var o=e[t.key];o&&("string"!=typeof o&&(o=JSON.stringify(o)),-1!==o.toLowerCase().indexOf(t.value)&&a.push(e))}}),a.length===o.length&&s.push(e)}),s}}),lo30NgApp.filter("percentage",["$filter",function(e){return function(a,t){return e("number")(100*a,t)+"%"}}]),lo30NgApp.factory("apiBaseService",function(e,a){var t="/api/",o={};return o.execute=function(o){var s=o.apiDataType,l=o.urlPartial,r=o.method,n=o.params,i=t+l,c={url:i,method:r};return"GET"===r?c.params=JSON.parse(JSON.stringify(n)):c.data=JSON.parse(JSON.stringify(n)),a(c).then(function(a){return e.debug(s,a),a.data})["catch"](function(a){throw e.error(s,a),a})},o}),lo30NgApp.factory("apiService",function(e,a){var t=e._,o={dataProcessing:{},games:{},goalieStatCareers:{},goalieStatGames:{},goalieStatSeasons:{},goalieStatTeams:{},playerStatCareers:{},playerStatGames:{},playerStatSeasons:{},playerStatTeams:{},scoreSheetEntryProcessedGoals:{},scoreSheetEntryProcessedPenalties:{},seasons:{},teams:{},teamStandings:{}};return o.dataProcessing.getLastGameProcessedForSeasonId=function(e){var t={apiDataType:"dataProcessing.getLastGameProcessedForSeasonId",urlPartial:"dataprocessing/lastprocessedgameid/seasons/"+e,method:"GET",params:null};return a.execute(t)},o.games.getForGameId=function(e){var t={apiDataType:"games.getForGameId",urlPartial:"games/"+e,method:"GET",params:null};return a.execute(t)},o.games.listForSeasonIdTeamId=function(e,t){var o={apiDataType:"games.listForSeasonIdTeamId",urlPartial:"games/seasons/"+e+"/teams/"+t,method:"GET",params:null};return a.execute(o)},o.games.listForSeasonId=function(e){var t={apiDataType:"games.listForSeasonId",urlPartial:"games/seasons/"+e,method:"GET",params:null};return a.execute(t)},o.goalieStatCareers.getForPlayerId=function(e){var t={apiDataType:"goalieStatCareers.getForPlayerId",urlPartial:"goaliestatcareers/players/"+e,method:"GET",params:null};return a.execute(t)},o.goalieStatSeasons.listForPlayerId=function(e){var t={apiDataType:"goalieStatSeasons.listForPlayerId",urlPartial:"goaliestatseasons/players/"+e,method:"GET",params:null};return a.execute(t)},o.goalieStatSeasons.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"goalieStatSeasons.listForPlayerId",urlPartial:"goaliestatseasons/players/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.goalieStatTeams.listForSeasonIdPlayoffs=function(e,t){var o={apiDataType:"goalieStatTeams.listForSeasonIdPlayoffs",urlPartial:"goaliestatteams/seasons/"+e+"/playoffs/"+t,method:"GET",params:null};return a.execute(o)},o.goalieStatTeams.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"goalieStatTeams.listForSeasonIdPlayerId",urlPartial:"goaliestatteams/players/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.goalieStatGames.listForGameId=function(e){var t={apiDataType:"goalieStatGames.listForGameId",urlPartial:"goaliestatgames/games/"+e,method:"GET",params:null};return a.execute(t)},o.goalieStatGames.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"goalieStatGames.listForSeasonIdPlayerId",urlPartial:"goaliestatgames/goalies/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.playerStatCareers.getForPlayerId=function(e){var t={apiDataType:"playerStatCareers.getForPlayerId",urlPartial:"playerstatcareers/players/"+e,method:"GET",params:null};return a.execute(t)},o.playerStatGames.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"playerStatGames.listForSeasonIdPlayerId",urlPartial:"playerstatgames/players/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.playerStatSeasons.listForPlayerId=function(e){var t={apiDataType:"playerStatSeasons.listForPlayerId",urlPartial:"playerstatseasons/players/"+e,method:"GET",params:null};return a.execute(t)},o.playerStatSeasons.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"playerStatSeasons.listForPlayerId",urlPartial:"playerstatseasons/players/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.playerStatTeams.listForSeasonIdPlayoffs=function(e,t){var o={apiDataType:"playerStatTeams.listForSeasonIdPlayoffs",urlPartial:"playerstatteams/seasons/"+e+"/playoffs/"+t,method:"GET",params:null};return a.execute(o)},o.playerStatTeams.listForPlayerIdSeasonId=function(e,t){var o={apiDataType:"playerStatTeams.listForSeasonIdPlayerId",urlPartial:"playerstatteams/players/"+e+"/seasons/"+t,method:"GET",params:null};return a.execute(o)},o.scoreSheetEntryProcessedGoals.listForGameId=function(e){var t={apiDataType:"scoreSheetEntryProcessedGoals.listForGameId",urlPartial:"scoresheetentries/processed/goals/games/"+e,method:"GET",params:null};return a.execute(t)},o.scoreSheetEntryProcessedPenalties.listForGameId=function(e){var t={apiDataType:"scoreSheetEntryProcessedPenalties.listForGameId",urlPartial:"scoresheetentries/processed/penalties/games/"+e,method:"GET",params:null};return a.execute(t)},o.seasons.list=function(){var e={apiDataType:"seasons.list",urlPartial:"seasons",method:"GET",params:null};return a.execute(e).then(function(e){return t.reject(e,function(e){return-1===e.seasonId})})},o.seasons.listForSeasonsWithGameSelection=function(){var e={apiDataType:"seasons.list",urlPartial:"seasons",method:"GET",params:null};return a.execute(e).then(function(e){return t.filter(e,function(e){return e.seasonId>=43})})},o.teams.listForSeasonId=function(e){var t={apiDataType:"teams.listForSeasonId",urlPartial:"teams/seasons/"+e,method:"GET",params:null};return a.execute(t)},o.teamStandings.listForSeasonIdPlayoffs=function(e,t){var o={apiDataType:"teamStandings.listForSeasonIdPlayoffs",urlPartial:"teamstandings/seasons/"+e+"/playoffs/"+t,method:"GET",params:null};return a.execute(o)},o.teamStandings.listForSeasonIdTeamId=function(e,t){var o={apiDataType:"teamStandings.listForSeasonIdTeamId",urlPartial:"teamstandings/seasons/"+e+"/teams/"+t,method:"GET",params:null};return a.execute(o)},o}),lo30NgApp.factory("broadcastService",["$log","$rootScope",function(e,a){var t={},o={seasonSet:"seasonSet",seasonTypeSet:"seasonTypeSet",gameSet:"gameSet"},s={seasonSet:0,seasonTypeSet:0,gameSet:0};return t.events=function(){return o},t.emittedEventsCount=function(e){return s[e]},t.emitEvent=function(t){o[t]?(e.debug("Broadcast service emitted event: "+t),a.$broadcast(t),s[t]=s[t]+1):e.error("emitEvent unknown event name: "+t,"broadcastService")},t}]),lo30NgApp.factory("criteriaService",function(e,a,t,o,s){var l,r,n,i=o._,c={season:{},seasonType:{},game:{},gameLastProcessed:{}},m={season:"not set",seasonType:"not set",game:"not set"},p=function(){return e.debug("criteriaService.fetchSeasons()"),l=[],t.seasons.listForSeasonsWithGameSelection().then(function(e){if(l=e,c.season.isNotSet()){var a=i.find(l,function(e){return e.isCurrentSeason===!0});return c.season.set(a)}return c.season.get()})},y=function(a,t){return e.debug("criteriaService.fetchSeasonTypes()  for seasonId:"+t+" for gamePlayoffs: "+a),n=["Regular Season","Playoffs"],c.seasonType.set(a?"Playoffs":"Regular Season")},u=function(a){return e.debug("criteriaService.fetchGames() for seasonId:"+a),r=[],t.games.listForSeasonId(a).then(function(e){return r=e,t.dataProcessing.getLastGameProcessedForSeasonId(a)}).then(function(e){var a=i.find(r,function(a){return a.gameId===e.gameId});return c.game.set(a)})};return c.initialize=function(){return a(function(t,o){var l=[];c.season.isNotSet()?l.push(p()):(e.debug("criteriaService.initialize() season already set"),s.emitEvent(s.events().seasonSet)),c.game.isNotSet()||(e.debug("criteriaService.initialize() game already set"),s.emitEvent(s.events().gameSet)),c.seasonType.isNotSet()||(e.debug("criteriaService.initialize() seasonType already set"),s.emitEvent(s.events().seasonTypeSet)),a.all(l)["finally"](function(e){return t(e)},function(a){return e.error("Error while trying to criteriaService.initialize()",a),o(a)})})},c.season={isNotSet:function(){return"not set"===m.season?!0:!1},get:function(){return m.season},set:function(e){return a(function(a){return m.season!==e?(m.season=e,s.emitEvent(s.events().seasonSet),u(e.seasonId).then(function(){return a(m.season)})):a(m.season)})},setById:function(e){return a(function(a){if(m.season.seasonId!==e){var t=i.find(l,function(a){return a.seasonId===e});return c.season.set(t)}return a(m.season)})},data:function(){return l?l.reverse():l}},c.seasonType={isNotSet:function(){return"not set"===m.seasonType?!0:!1},get:function(){return m.seasonType},set:function(e){return a(function(a){return m.seasonType!==e&&(m.seasonType=e,s.emitEvent(s.events().seasonTypeSet)),a(m.seasonType)})},data:function(){return n}},c.game={isNotSet:function(){return"not set"===m.game?!0:!1},get:function(){return m.game},set:function(e){return a(function(a){return m.game!==e?(m.game=e,s.emitEvent(s.events().gameSet),y(e.playoffs,e.seasonId).then(function(){return a(m.game)})):a(m.game)})},setById:function(e){return a(function(a){if(m.game.gameId!==e){var t=i.find(r,function(a){return a.gameId===e});return c.game.set(t)}return a(m.game)})},data:function(){return r?r.reverse():r}},c}),lo30NgApp.factory("externalLibService",[function(){var e=_,a=sjv,t=moment;return{_:e,sjv:a,moment:t}}]),lo30NgApp.directive("lo30CriteriaSelector",[function(){return{restrict:"E",templateUrl:"/views/directives/criteriaSelector.html",scope:{},controller:"lo30CriteriaSelectorController",link:function(e,a,t,o){}}}]),lo30NgApp.controller("lo30CriteriaSelectorController",["$log","$scope","broadcastService","externalLibService","apiService","criteriaService",function(e,a,t,o,s,l){var r=(o._,o.sjv);a.initializeScopeVariables=function(){a.local={seasons:[],games:[],seasonTypes:[]}},a.setWatches=function(){a.$watch("local.selectedSeason",function(e,t){r.isNotEmpty(e)&&r.isNotEmpty(t)&&e!==t&&l.season.set(a.local.selectedSeason)}),a.$watch("local.selectedSeasonType",function(e,t){r.isNotEmpty(e)&&r.isNotEmpty(t)&&e!==t&&l.seasonType.set(a.local.selectedSeasonType)}),a.$watch("local.selectedGame",function(e,t){r.isNotEmpty(e)&&r.isNotEmpty(t)&&e!==t&&l.game.set(a.local.selectedGame)})},a.activate=function(){a.initializeScopeVariables(),a.setWatches(),a.local.seasons=l.season.data(),a.local.selectedSeason=l.season.get(),a.local.seasonTypes=l.seasonType.data(),a.local.selectedSeasonType=l.seasonType.get(),a.local.games=l.game.data(),a.local.selectedGame=l.game.get()},a.activate()}]),lo30NgApp.directive("lo30FilterBy",[function(){return{restrict:"E",templateUrl:"/views/directives/filterBy.html",scope:{gameId:"="},controller:"lo30FilterByController",link:function(e,a,t,o){}}}]),lo30NgApp.controller("lo30FilterByController",["$log","$scope","externalLibService","apiService","screenSize",function(e,a,t,o,s){t._;a.initializeScopeVariables=function(){a={teams:[],fetchTeamsCompleted:!1}},a.fetchTeams=function(e){a.local.fetchTeamsCompleted=!1,a.local.teams=[],o.teams.listForSeasonId(e).then(function(e){a.local.teams=e,angular.forEach(e,function(e,a){e.teamNameToDisplay=s.is("xs, sm")?e.teamCode:s.is("md")?e.teamNameShort:e.teamNameShort})})["finally"](function(){a.local.fetchScoreSheetEntryGoalsCompleted=!0})},a.activate=function(){a.initializeScopeVariables(),a.fetchTeams(a.seasonId)},a.activate()}]),lo30NgApp.directive("lo30DatatablesFilterRowHider",[function(){return{restrict:"E",templateUrl:"/views/directives/datatablesFilterRowHider.html",scope:{},link:function(e,a,t,o){{var s=a.parents("div");s.find("datatables-filter-row")}}}}]),lo30NgApp.directive("lo30Footable",[function(e){return{link:{post:function(a,t){if(!a.$last)return!1;var o=t.parents("table");a.$evalAsync(function(){o.hasClass("footable-loaded")||o.footable(),o.data("__FooTable__").draw(),e(t.contents())(a)})}},pre:function(a,t){e(t.contents())(a)}}}]),lo30NgApp.directive("lo30FootableFilterInput",[function(){return{restrict:"E",template:'<input id="filter" type="text" class="input-datatables-filter" />',scope:{},link:function(a,t,o,s){t.parents("table");e.preventDefault();var l=$("table").data("footable-filter");alert('about to filter table by "tech"'),l.filter("tech"),confirm("clear filter now?")&&l.clearFilter()}}}]),lo30NgApp.directive("lo30GameScoreByPeriodDetailGoalies",[function(){return{restrict:"E",templateUrl:"/views/directives/gameScoreByPeriodDetailGoalies.html",scope:{goalieStatGameWinner:"=",
goalieStatGameLoser:"=",goalieStatGames:"="},link:function(e,a,t,o){}}}]),lo30NgApp.directive("lo30GameScoreByPeriodDetail",[function(){return{restrict:"E",templateUrl:"/views/directives/gameScoreByPeriodDetail.html",scope:{gameId:"="},controller:"lo30GameScoreByPeriodDetailController",link:function(e,a,t,o){}}}]),lo30NgApp.controller("lo30GameScoreByPeriodDetailController",["$log","$scope","externalLibService","apiService","screenSize",function(e,a,t,o,s){t._;a.initializeScopeVariables=function(){a.local={scoreSheetEntryGoals:[],scoreSheetEntryScoring1st:[],scoreSheetEntryScoring2nd:[],scoreSheetEntryScoring3rd:[],scoreSheetEntryScoringOT:[],scoreSheetEntryPenalties:[],scoreSheetEntryPenalties1st:[],scoreSheetEntryPenalties2nd:[],scoreSheetEntryPenalties3rd:[],scoreSheetEntryPenaltiesOT:[],goalieStatGames:[],goalieStatGameWinner:{},goalieStatGameLoser:{},fetchScoreSheetEntryPenaltiesCompleted:!1,fetchScoreSheetEntryGoalsCompleted:!1,fetchGoalieStatGamesCompleted:!1}},a.fetchScoreSheetEntryGoals=function(e){a.local.fetchScoreSheetEntryGoalsCompleted=!1,a.local.scoreSheetEntriesGoals=[],o.scoreSheetEntryProcessedGoals.listForGameId(e).then(function(e){a.local.scoreSheetEntriesGoals=e,angular.forEach(e,function(e,t){e.goalPlayerNameToDisplay=e.goalPlayerFirstName+" "+e.goalPlayerLastName,e.goalPlayerLastNameSuffix&&(e.goalPlayerNameToDisplay=e.goalPlayerNameToDisplay+" "+e.goalPlayerLastNameSuffix),e.assist1PlayerLastName&&(e.assist1PlayerNameToDisplay=e.assist1PlayerFirstName+" "+e.assist1PlayerLastName,e.assist1PlayerLastNameSuffix&&(e.assist1PlayerNameToDisplay=e.assist1PlayerNameToDisplay+" "+e.assist1PlayerLastNameSuffix)),e.assist2PlayerLastName&&(e.assist2PlayerNameToDisplay=e.assist2PlayerFirstName+" "+e.assist2PlayerLastName,e.assist2PlayerLastNameSuffix&&(e.assist2PlayerNameToDisplay=e.assist2PlayerNameToDisplay+" "+e.assist2PlayerLastNameSuffix)),e.assist3PlayerLastName&&(e.assist3PlayerNameToDisplay=e.assist3PlayerFirstName+" "+e.assist3PlayerLastName,e.assist3PlayerLastNameSuffix&&(e.assist3PlayerLastNameSuffix=e.assist3PlayerLastNameSuffix+" "+e.assist3PlayerLastNameSuffix)),e.teamNameToDisplay=s.is("xs, sm")?e.teamCode:s.is("md")?e.teamNameShort:e.teamNameShort,1===e.period?a.local.scoreSheetEntryScoring1st.push(e):2===e.period?a.local.scoreSheetEntryScoring2nd.push(e):3===e.period?a.local.scoreSheetEntryScoring3rd.push(e):a.local.scoreSheetEntryScoringOT.push(e)})})["finally"](function(){a.local.fetchScoreSheetEntryGoalsCompleted=!0})},a.fetchScoreSheetEntryPenalties=function(e){a.local.fetchScoreSheetEntryPenaltiesCompleted=!1,a.local.scoreSheetEntryPenalties=[],o.scoreSheetEntryProcessedPenalties.listForGameId(e).then(function(e){a.local.scoreSheetEntryPenalties=e,angular.forEach(e,function(e,t){e.playerNameToDisplay=e.playerFirstName+" "+e.playerLastName,e.playerLastNameSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerLastNameSuffix),e.teamNameToDisplay=s.is("xs, sm")?e.teamCode:s.is("md")?e.teamNameShort:e.teamNameShort,1===e.period?a.local.scoreSheetEntryPenalties1st.push(e):2===e.period?a.local.scoreSheetEntryPenalties2nd.push(e):3===e.period?a.local.scoreSheetEntryPenalties3rd.push(e):a.local.scoreSheetEntryPenaltiesOT.push(e)})})["finally"](function(){a.local.fetchScoreSheetEntryPenaltiesCompleted=!0})},a.fetchGoalieStatGames=function(e){a.local.fetchGoalieStatGamesCompleted=!1,a.local.goalieStatGames=[],o.goalieStatGames.listForGameId(e).then(function(e){a.local.goalieStatGames=e,angular.forEach(e,function(e,t){e.playerNameToDisplay=e.playerFirstName+" "+e.playerLastName,e.playerLastNameSuffix&&(e.playerNameToDisplay=e.playerNameToDisplay+" "+e.playerLastNameSuffix),e.teamNameToDisplay=s.is("xs, sm")?e.teamCode:s.is("md")?e.teamNameShort:e.teamNameShort,1===e.wins?a.local.goalieStatGameWinner=e:a.local.goalieStatGameLoser=e})})["finally"](function(){a.local.fetchGoalieStatGamesCompleted=!0})},a.activate=function(){a.initializeScopeVariables(),a.fetchScoreSheetEntryGoals(a.gameId),a.fetchScoreSheetEntryPenalties(a.gameId),a.fetchGoalieStatGames(a.gameId)},a.activate()}]),lo30NgApp.directive("lo30GameScoreByPeriodDetailScoring",[function(){return{restrict:"E",templateUrl:"/views/directives/gameScoreByPeriodDetailScoring.html",scope:{scoreSheetEntryGoals:"="},link:function(e,a,t,o){}}}]),lo30NgApp.directive("lo30GameScoreByPeriodDetailPenalties",[function(){return{restrict:"E",templateUrl:"/views/directives/gameScoreByPeriodDetailPenalties.html",scope:{scoreSheetEntryPenalties:"="},link:function(e,a,t,o){}}}]),lo30NgApp.directive("lo30GameScoreByPeriodSummary",[function(){return{restrict:"E",templateUrl:"/views/directives/gameScoreByPeriodSummary.html",scope:{gameId:"="},controller:"lo30GameScoreByPeriodSummaryController",link:function(e,a,t,o){}}}]),lo30NgApp.controller("lo30GameScoreByPeriodSummaryController",["$log","$scope","externalLibService","apiService","screenSize",function(e,a,t,o,s){var l=t._;a.initializeScopeVariables=function(){a.local={game:{},fetchGameCompleted:!1}},a.fetchGame=function(e){a.local.fetchGameCompleted=!1,a.local.game={},o.games.getForGameId(e).then(function(e){a.local.game=e,a.buildGameToDisplay()})["finally"](function(){a.local.fetchPlayerStatGamesCompleted=!0})},a.buildGameToDisplay=function(){a.local.gameToDisplay=l.clone(a.local.game),s.is("xs, sm")?(a.local.gameToDisplay.teamNameAwayToDisplay=a.local.game.teamCodeAway,a.local.gameToDisplay.teamNameHomeToDisplay=a.local.game.teamCodeHome):s.is("md")?(a.local.gameToDisplay.teamNameAwayToDisplay=a.local.game.teamNameShortAway,a.local.gameToDisplay.teamNameHomeToDisplay=a.local.game.teamNameShortHome):(a.local.gameToDisplay.teamNameAwayToDisplay=a.local.game.teamNameLongAway,a.local.gameToDisplay.teamNameHomeToDisplay=a.local.game.teamNameLongHome)},a.activate=function(){a.initializeScopeVariables(),a.fetchGame(a.gameId)},a.activate()}]);